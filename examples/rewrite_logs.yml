sources:
  logs:
    type: demo_logs
    format:
      type: shuffle
      lines:
        - "{\"foo\": \"bar\"}"
        - "{}"
        - "{\"key\": \"value\"}"

transforms:
  rewrite:
    type: rewrite
    inputs:
      - logs
    script: |
      msg, err = parse_json(.message)
      del(.message)
      . = merge(msg, .)
      .rewrited = true

sinks:
  stdout:
    type: console
    inputs:
      - rewrite
    encoding:
      codec: json
